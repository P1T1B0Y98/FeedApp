# FeedApp


## Using .net backend
### Software needed
- Visual Studio (or other IDE of your choice)
- Postgresql

### Setting up Visual Studio
Download [Visual Studio Community Edition](https://visualstudio.microsoft.com/). When installing you will be prompted to install extra features, I installed the  ASP.NET and web development pack but I believe you can skip this for now and only download the required dependencies in the next step.

Select Open a project or solution (or clone a repository if you haven't already) and locate the FeedApp.sln file in the Backend folder and open it. If you try to run the project now you will get errors about missing dependencies. To fix this go to Tools -> NuGet Package Manager -> Package Manager Settings then click on Package Sources on the left. Press [+] and add `Name: nuget.org` and `Source: https://api.nuget.org/v3/index.json` and click ok. If you now try to run the program via the ▶️FeedApp button on the top toolbar it will install all required dependencies then launch. 

Launching the program will by default open an autogenerated Swagger page at https://localhost:7280/swagger/index.html which in some browsers is flagged as potentially unsafe (at least Firefox), in which case you will have to allow loading the page in your browser in order to use the Swagger ui to test the api (note that the API is still running even if you dont do this, so you can use it via other tools such as postman). 

### Configuring postgresql
To configure the postgresql database i use [pgAdmin](https://www.pgadmin.org/) which should be installed with postgresql, however you can use the command line if you prefer. Create a new database and call it FeedApp.
If you open the API project and click on Connected Services you will see Secrets.json (Local) in service dependencies, click the ... on the right and Manage User Secrets. Here you want to configure the path our postgresql database deployed in Microsoft Azure.
An example of how it should look:
```json
{
      "ConnectionStrings:ConnectionString": "Server=myserver54321.postgres.database.azure.com;Database=FeedApp;Port=5432;User    Id=myadmin;Password=Isergodt123;Ssl Mode=Prefer; Trust Server Certificate=true"
}

```
The last step is to open Tools -> NuGet Package Manager -> Package Manager Console and doing the following two commands:

`dotnet tool install --global dotnet-ef`

`dotnet ef database update --project Database --startup-project API`

Now you should be able to test all the endpoints after launching the app.

### Authenticating swagger
Some endpoints require the user to be logged in to access them, to do so you must first create a user, then log in to that user with the /api/user/login endpoint. This returns a JWT which you need to copy to your clipboard. Go to the top of the page and click Authorize and paste the JWT you got. This token is valid for 30 minutes as of writing this, but you can alter this in API/appsettings.json and changing the expiresIn field under JwtConfig (then saving and restarting the application).

### To run the backend
Navigate into the backend/API folder and run the following in terminal
`dotnet run`
